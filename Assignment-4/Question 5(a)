#include<stdio.h>
#define SIZE 5

int q1[SIZE], q2[SIZE];
int f1 = -1, r1 = -1, f2 = -1, r2 = -1;

void enqueue(int q[], int *f, int *r, int value) {
    if(*r == SIZE-1) {
        printf("Queue full!\n");
    } else {
        if(*f == -1) *f = 0;
        (*r)++;
        q[*r] = value;
    }
}

int dequeue(int q[], int *f, int *r) {
    if(*f == -1) return -1;
    int value = q[*f];
    (*f)++;
    if(*f > *r) *f = *r = -1;
    return value;
}

void push(int value) {
    enqueue(q1, &f1, &r1, value);
    printf("Pushed: %d\n", value);
}

void pop() {
    if(f1 == -1) {
        printf("Stack empty!\n");
        return;
    }
    
    // Move all elements except last from q1 to q2
    while(f1 != r1) {
        int val = dequeue(q1, &f1, &r1);
        enqueue(q2, &f2, &r2, val);
    }
    
    // Last element is the one to pop
    int popped = dequeue(q1, &f1, &r1);
    printf("Popped: %d\n", popped);
    
    // Swap q1 and q2
    int tempf = f1, tempr = r1;
    f1 = f2; r1 = r2;
    f2 = tempf; r2 = tempr;
}

int main() {
    push(10);
    push(20);
    push(30);
    pop();
    pop();
    
    return 0;
}
